<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1144px" preserveAspectRatio="none" style="width:534px;height:1144px;background:#FFFFFF;" version="1.1" viewBox="0 0 534 1144" width="534px" zoomAndPan="magnify"><defs><filter height="300%" id="f1j5vu3pxfs3w4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1j5vu3pxfs3w4)" height="279.9297" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="61.2969"/><rect fill="#FFFFFF" filter="url(#f1j5vu3pxfs3w4)" height="117.6641" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="413.4922"/><rect fill="#FFFFFF" filter="url(#f1j5vu3pxfs3w4)" height="270.4063" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="545.1563"/><rect fill="#FFFFFF" height="117.0703" style="stroke:none;stroke-width:1.0;" width="510.5" x="10" y="566.2891"/><rect fill="#FFFFFF" height="132.2031" style="stroke:none;stroke-width:1.0;" width="510.5" x="10" y="683.3594"/><rect fill="#FFFFFF" filter="url(#f1j5vu3pxfs3w4)" height="102.5313" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="829.5625"/><rect fill="#FFFFFF" filter="url(#f1j5vu3pxfs3w4)" height="134.5313" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="946.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="44.2969" y2="82.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="82.4297" y2="114.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="114.4297" y2="195.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="195.8281" y2="227.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="227.8281" y2="309.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="309.2266" y2="341.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="341.2266" y2="651.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="651.3594" y2="683.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="683.3594" y2="783.5625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="783.5625" y2="815.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="815.5625" y2="1048.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="1048.625" y2="1080.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="1080.625" y2="1097.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="44.2969" y2="82.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="412.5" x2="412.5" y1="82.4297" y2="114.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="114.4297" y2="195.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="412.5" x2="412.5" y1="195.8281" y2="227.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="227.8281" y2="309.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="412.5" x2="412.5" y1="309.2266" y2="341.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="341.2266" y2="651.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="412.5" x2="412.5" y1="651.3594" y2="683.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="683.3594" y2="783.5625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="412.5" x2="412.5" y1="783.5625" y2="815.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="815.5625" y2="1048.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="412.5" x2="412.5" y1="1048.625" y2="1080.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="412.5" x2="412.5" y1="1080.625" y2="1097.625"/><rect fill="#FEFECE" filter="url(#f1j5vu3pxfs3w4)" height="34.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="70" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="79" y="26.9951">FHIR Server</text><rect fill="#FEFECE" filter="url(#f1j5vu3pxfs3w4)" height="34.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="70" y="1096.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="79" y="1118.6201">FHIR Server</text><rect fill="#FEFECE" filter="url(#f1j5vu3pxfs3w4)" height="34.2969" style="stroke:#A80036;stroke-width:1.5;" width="92" x="364.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="373.5" y="26.9951">Subscriber</text><rect fill="#FEFECE" filter="url(#f1j5vu3pxfs3w4)" height="34.2969" style="stroke:#A80036;stroke-width:1.5;" width="92" x="364.5" y="1096.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="373.5" y="1118.6201">Subscriber</text><path d="M10,61.2969 L190,61.2969 L190,72.2969 L180,82.2969 L10,82.2969 L10,61.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="279.9297" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="61.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131" x="27" y="76.3638">Normal Operation</text><polygon fill="#A80036" points="400.5,150.6953,410.5,154.6953,400.5,158.6953,404.5,154.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="406.5" y1="154.6953" y2="154.6953"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="144" x="129.5" y="132.4966">event-notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="129.5" y="147.6294">event number:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="227.5" y="147.6294">25</text><polygon fill="#A80036" points="131.5,183.8281,121.5,187.8281,131.5,191.8281,127.5,187.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125.5" x2="411.5" y1="187.8281" y2="187.8281"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="139.5" y="180.7622">200: OK</text><polygon fill="#A80036" points="400.5,264.0938,410.5,268.0938,400.5,272.0938,404.5,268.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="406.5" y1="268.0938" y2="268.0938"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="144" x="129.5" y="245.895">event-notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="129.5" y="261.0278">event number:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="227.5" y="261.0278">26</text><polygon fill="#A80036" points="131.5,297.2266,121.5,301.2266,131.5,305.2266,127.5,301.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125.5" x2="411.5" y1="301.2266" y2="301.2266"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="139.5" y="294.1606">200: OK</text><path d="M206,353.2266 L206,397.2266 L403,397.2266 L403,363.2266 L393,353.2266 L206,353.2266 " fill="#FBFB77" filter="url(#f1j5vu3pxfs3w4)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M393,353.2266 L393,363.2266 L403,363.2266 L393,353.2266 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="214" y="372.2935">Heartbeat timeout elapses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="214" y="387.4263">without a notification...</text><path d="M10,413.4922 L253,413.4922 L253,424.4922 L243,434.4922 L10,434.4922 L10,413.4922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="117.6641" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="413.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="194" x="27" y="428.5591">Check Subscription Status</text><polygon fill="#A80036" points="131.5,455.7578,121.5,459.7578,131.5,463.7578,127.5,459.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="125.5" x2="411.5" y1="459.7578" y2="459.7578"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="264" x="139.5" y="452.6919">GET .../Subscription/&lt;id&gt;/$status</text><polygon fill="#A80036" points="400.5,519.1563,410.5,523.1563,400.5,527.1563,404.5,523.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="406.5" y1="523.1563" y2="523.1563"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="144" x="129.5" y="485.8247">SubscriptionStatus</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="129.5" y="500.9575">state:</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="185.5" y="500.9575">error</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="232" x="129.5" y="516.0903">eventsSinceSubscriptionStart:</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="369.5" y="516.0903">28</text><path d="M10,545.1563 L189,545.1563 L189,556.1563 L179,566.1563 L10,566.1563 L10,545.1563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="270.4063" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="545.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130" x="27" y="560.2231">Recovery Process</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="520.5" y1="567.2891" y2="567.2891"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="98" x="17" y="579.4995">[via FHIR REST]</text><polygon fill="#A80036" points="131.5,606.2266,121.5,610.2266,131.5,614.2266,127.5,610.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="125.5" x2="411.5" y1="610.2266" y2="610.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="139.5" y="603.1606">FHIR Search</text><polygon fill="#A80036" points="400.5,639.3594,410.5,643.3594,400.5,647.3594,404.5,643.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="406.5" y1="643.3594" y2="643.3594"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="129.5" y="636.2935">Bundle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="181.5" y="636.2935">with matching resources</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="520.5" y1="684.3594" y2="684.3594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="24" x="17" y="696.5698">[via</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49" x="45" y="696.5698">$events</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="94" y="696.5698">]</text><polygon fill="#A80036" points="131.5,738.4297,121.5,742.4297,131.5,746.4297,127.5,742.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="125.5" x2="411.5" y1="742.4297" y2="742.4297"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="139.5" y="720.231">$events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="195.5" y="720.231">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="139.5" y="735.3638">Events newer than</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="261.5" y="735.3638">26</text><polygon fill="#A80036" points="400.5,771.5625,410.5,775.5625,400.5,779.5625,404.5,775.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="406.5" y1="775.5625" y2="775.5625"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="129.5" y="768.4966">Bundle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="181.5" y="768.4966">with matching events</text><path d="M10,829.5625 L230,829.5625 L230,840.5625 L220,850.5625 L10,850.5625 L10,829.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="102.5313" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="829.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171" x="27" y="844.6294">Re-enable Subscription</text><polygon fill="#A80036" points="131.5,886.9609,121.5,890.9609,131.5,894.9609,127.5,890.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="125.5" x2="411.5" y1="890.9609" y2="890.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="139.5" y="868.7622">Update Subscription</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="104" x="139.5" y="883.895">state: active</text><polygon fill="#A80036" points="400.5,920.0938,410.5,924.0938,400.5,928.0938,404.5,924.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="406.5" y1="924.0938" y2="924.0938"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="129.5" y="917.0278">200: OK</text><path d="M10,946.0938 L254,946.0938 L254,957.0938 L244,967.0938 L10,967.0938 L10,946.0938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="134.5313" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="946.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="195" x="27" y="961.1606">Resume Normal Operation</text><polygon fill="#A80036" points="400.5,1003.4922,410.5,1007.4922,400.5,1011.4922,404.5,1007.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="406.5" y1="1007.4922" y2="1007.4922"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="144" x="129.5" y="985.2935">event-notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="129.5" y="1000.4263">event number:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="227.5" y="1000.4263">29</text><polygon fill="#A80036" points="131.5,1036.625,121.5,1040.625,131.5,1044.625,127.5,1040.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125.5" x2="411.5" y1="1040.625" y2="1040.625"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="139.5" y="1033.5591">200: OK</text><!--MD5=[c410d47dd84a80bbe6e051f0e3e8795d]
@startuml
skinparam NoteTextAlignment left
skinparam Padding 2
skinparam ParticipantPadding 50
skinparam LifelineStrategy solid

participant "FHIR Server" as S
participant Subscriber    as C

group Normal Operation
  ...
  S -> C: ""event-notification""\nevent number: **25**
  return ""200: OK""
  ...
  S -> C: ""event-notification""\nevent number: **26**
  return ""200: OK""
  ...
end

note left of C
  Heartbeat timeout elapses
  without a notification...
end note

group Check Subscription Status
  C -> S: ""GET .../Subscription/<id>/$status""
  return ""SubscriptionStatus""\n""state: **error**""\n""eventsSinceSubscriptionStart: **28**""
end

group Recovery Process
else via FHIR REST
  C -> S: FHIR Search
  return ""Bundle"" with matching resources
  ...
else via ""$events""
  C -> S: ""$events"":\nEvents newer than **26**
  return ""Bundle"" with matching events
  ...

end

group Re-enable Subscription
  C -> S:Update Subscription\n""state: active""
  return ""200: OK""
end

group Resume Normal Operation
  S -> C: ""event-notification""\nevent number: **29**
  return ""200: OK""
  ...
end
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>